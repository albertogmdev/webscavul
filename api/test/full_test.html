<!DOCTYPE html>
<html lang="es">

<head>
    <!-- CORRECTO: charset utf-8 configurado -->
    <meta charset="utf-8">

    <!-- DEBE DETECTAR: Meta tag generator encontrada -->
    <meta name="generator" content="WordPress 6.0">

    <!-- DEBE DETECTAR: Meta tag referrer con valor no recomendado -->
    <meta name="referrer" content="unsafe-url">

    <!-- CORRECTO: Meta robots configurada -->
    <meta name="robots" content="index, follow">

    <!-- DEBE DETECTAR: Meta tag CSP no configurada - si no hay header CSP -->
    <!-- Si hay CSP por header, esto no debería detectarse -->

    <!-- DEBE DETECTAR: Meta tag refresh con redirección insegura -->
    <meta http-equiv="refresh" content="300;url=http://test-site.com">

    <!-- CORRECTO: Link con HTTPS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">

    <!-- DEBE DETECTAR: Link externo inseguro HTTP -->
    <link rel="stylesheet" href="http://insecure-cdn.com/style.css">

    <!-- DEBE DETECTAR: Link sin crossorigin ni integrity -->
    <link rel="stylesheet" href="https://external-cdn.com/style.css">

    <!-- DEBE DETECTAR: Link con crossorigin sin integrity -->
    <link rel="stylesheet" href="https://external-cdn.com/style2.css" crossorigin="anonymous">

    <!-- DEBE DETECTAR: Link con integrity sin crossorigin -->
    <link rel="stylesheet" href="https://external-cdn.com/style3.css" integrity="sha384-example">

    <!-- CORRECTO: Link con crossorigin e integrity configurados -->
    <link rel="stylesheet" href="https://external-cdn.com/style4.css" crossorigin="anonymous"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3">

    <!-- DEBE DETECTAR: Link con atributos deprecados -->
    <link rel="stylesheet" href="style.css" charset="utf-8" rev="stylesheet">

    <!-- DEBE DETECTAR: Script externo inseguro HTTP -->
    <script src="http://insecure-cdn.com/script.js"></script>

    <!-- DEBE DETECTAR: Script sin crossorigin ni integrity -->
    <script src="https://external-cdn.com/script.js"></script>

    <!-- DEBE DETECTAR: Script con crossorigin sin integrity -->
    <script src="https://external-cdn.com/script2.js" crossorigin="anonymous"></script>

    <!-- DEBE DETECTAR: Script con integrity sin crossorigin -->
    <script src="https://external-cdn.com/script3.js" integrity="sha384-example"></script>

    <!-- CORRECTO: Script con crossorigin e integrity configurados -->
    <script src="https://external-cdn.com/script4.js" crossorigin="anonymous"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"></script>

    <!-- CORRECTO: Script local sin problemas -->
    <script src="js/local-script.js"></script>

    <title>Página de Prueba de Vulnerabilidades</title>
</head>

<body>
    <h1>Página de Prueba para Detección de Vulnerabilidades</h1>

    <h2>Vulnerabilidades en Scripts</h2>
    <p>Ya incluidos en el head de la página</p>

    <h2>Vulnerabilidades en Scripts</h2>
    <p>Ya incluidos en el head de la página</p>

    <h2>Vulnerabilidades en Formularios</h2>

    <!-- DEBE DETECTAR: Formulario sin token CSRF -->
    <form id="form-vulnerable-1" action="process.php" method="post">
        <label for="username">Usuario:</label>
        <input type="text" id="username" name="username">
        <label for="password">Contraseña:</label>
        <input type="password" id="password" name="password">
        <button type="submit">Enviar</button>
    </form>

    <!-- DEBE DETECTAR: Formulario con action HTTP externo -->
    <form id="form-vulnerable-2" action="http://test-site.com/process" method="post">
        <input type="hidden" name="csrf_token" value="abc123">
        <label for="data">Datos:</label>
        <input type="text" id="data" name="data">
        <button type="submit">Enviar</button>
    </form>

    <!-- DEBE DETECTAR: Formulario con datos confidenciales en GET -->
    <form id="form-vulnerable-3" action="login.php" method="get">
        <input type="hidden" name="csrf_token" value="abc123">
        <label for="user">Usuario:</label>
        <input type="text" id="user" name="user">
        <label for="pass">Contraseña:</label>
        <input type="password" id="pass" name="password">
        <button type="submit">Login</button>
    </form>

    <!-- DEBE DETECTAR: Formulario sin action -->
    <form id="form-vulnerable-4" method="post">
        <input type="hidden" name="csrf_token" value="abc123">
        <label for="comment">Comentario:</label>
        <textarea id="comment" name="comment"></textarea>
        <button type="submit">Comentar</button>
    </form>

    <!-- DEBE DETECTAR: Campo password con tipo text -->
    <form id="form-vulnerable-5" action="change-password.php" method="post">
        <input type="hidden" name="csrf_token" value="abc123">
        <label for="old-pwd">Contraseña actual:</label>
        <input type="text" id="old-pwd" name="password_old">
        <label for="new-pwd">Nueva contraseña:</label>
        <input type="password" id="new-pwd" name="password_new">
        <button type="submit">Cambiar</button>
    </form>

    <!-- DEBE DETECTAR: Campo password en textarea -->
    <form id="form-vulnerable-6" action="process.php" method="post">
        <input type="hidden" name="csrf_token" value="abc123">
        <label for="pwd-area">Contraseña:</label>
        <textarea id="pwd-area" name="password"></textarea>
        <button type="submit">Enviar</button>
    </form>

    <!-- DEBE DETECTAR: Formulario login sin CSRF -->
    <form id="form-login-vulnerable" action="login.php" method="post">
        <label for="login-user">Usuario:</label>
        <input type="text" id="login-user" name="username">
        <label for="login-pass">Contraseña:</label>
        <input type="password" id="login-pass" name="password">
        <button type="submit">Iniciar Sesión</button>
    </form>

    <!-- CORRECTO: Formulario con CSRF token -->
    <form id="form-correct-1" action="https://secure-site.com/process" method="post">
        <input type="hidden" name="csrf_token" value="secure-token-123">
        <label for="safe-data">Datos seguros:</label>
        <input type="text" id="safe-data" name="data">
        <button type="submit">Enviar Seguro</button>
    </form>

    <!-- CORRECTO: Formulario con captcha -->
    <form id="form-correct-2" action="submit.php" method="post">
        <div class="g-recaptcha" data-sitekey="your-site-key"></div>
        <label for="message">Mensaje:</label>
        <textarea id="message" name="message"></textarea>
        <button type="submit">Enviar</button>
    </form>

    <h2>Vulnerabilidades en Enlaces</h2>

    <!-- DEBE DETECTAR: Enlace externo inseguro HTTP -->
    <a href="http://insecure-site.com" id="link-vulnerable-1">Sitio Inseguro</a>

    <!-- DEBE DETECTAR: Enlace con target _blank sin rel -->
    <a href="https://external-site.com" target="_blank" id="link-vulnerable-2">Abrir en nueva ventana sin protección</a>

    <!-- DEBE DETECTAR: Enlace con target _blank sin noopener -->
    <a href="https://external-site.com" target="_blank" rel="noreferrer" id="link-vulnerable-3">Solo noreferrer</a>

    <!-- DEBE DETECTAR: Enlace con target _blank sin noreferrer -->
    <a href="https://external-site.com" target="_blank" rel="noopener" id="link-vulnerable-4">Solo noopener</a>

    <!-- CORRECTO: Enlace interno -->
    <a href="about.html" id="link-correct-1">Página Interna</a>

    <!-- CORRECTO: Enlace externo seguro -->
    <a href="https://secure-external-site.com" id="link-correct-2">Sitio Externo Seguro</a>

    <!-- CORRECTO: Enlace con target _blank y rel completo -->
    <a href="https://external-site.com" target="_blank" rel="noopener noreferrer" id="link-correct-3">Enlace Seguro
        Externo</a>

    <!-- CORRECTO: Enlace sin target _blank -->
    <a href="https://external-site.com" id="link-correct-4">Enlace sin target blank</a>

    <h2>Casos Especiales y Pruebas Adicionales</h2>

    <!-- Formulario con múltiples vulnerabilidades -->
    <form id="multi-vulnerable-form" action="http://bad-site.com" method="get">
        <label for="pwd-text">Password como text:</label>
        <input type="text" id="pwd-text" name="contrasena">
        <label for="pwd-textarea">Password en textarea:</label>
        <textarea id="pwd-textarea" name="pwd"></textarea>
        <button type="submit">Múltiples Vulnerabilidades</button>
    </form>

    <!-- Formulario vacío para probar action vacío -->
    <form id="empty-action-form" action="" method="post">
        <input type="hidden" name="csrf_token" value="token">
        <input type="text" name="test">
        <button type="submit">Action Vacío</button>
    </form>

    <!-- Enlaces con diferentes casos -->
    <div>
        <a href="mailto:test@example.com">Email Link</a> <!-- NO debe detectar -->
        <a href="javascript:void(0)">JavaScript Link</a> <!-- NO debe detectar -->
        <a href="#section">Anchor Link</a> <!-- NO debe detectar -->
        <a href="tel:+1234567890">Phone Link</a> <!-- NO debe detectar -->
    </div>
</body>

</html>